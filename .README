 DealExpress â€“ API Backend (Node.js / Express / MongoDB)

DealExpress est une API REST complÃ¨te permettant de gÃ©rer des deals, votes, commentaires, utilisateurs, modÃ©rateurs et administrateurs.

Ce projet a Ã©tÃ© dÃ©veloppÃ© dans le cadre dâ€™un exercice pratique visant Ã  mettre en place :

un systÃ¨me dâ€™authentification sÃ©curisÃ© (JWT)

un CRUD complet sur les deals

un systÃ¨me de modÃ©ration

un systÃ¨me de votes (hot / cold)

un systÃ¨me de commentaires sur les deals

une gestion des rÃ´les (user / moderator / admin)

une base de donnÃ©es MongoDB structurÃ©e

 1. Technologies utilisÃ©es

Node.js

Express.js

MongoDB + Mongoose

JWT (JSON Web Token)

bcryptjs

express-validator

dotenv

Nodemon (pour le dÃ©veloppement)

2. Structure du projet
src/
â”‚
â”œâ”€â”€ app.js
â”œâ”€â”€ config/
â”‚   â””â”€â”€ database.js
â”‚
â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ auth.controller.js
â”‚   â”œâ”€â”€ deal.controller.js
â”‚   â”œâ”€â”€ comment.controller.js
â”‚   â””â”€â”€ admin.controller.js
â”‚
â”œâ”€â”€ middlewares/
â”‚   â”œâ”€â”€ auth.middleware.js
â”‚   â””â”€â”€ role.middleware.js
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ User.js
â”‚   â”œâ”€â”€ Deal.js
â”‚   â””â”€â”€ Comment.js
â”‚
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.routes.js
â”‚   â”œâ”€â”€ deals.routes.js
â”‚   â”œâ”€â”€ comments.routes.js
â”‚   â””â”€â”€ admin.routes.js
â”‚
â””â”€â”€ validators/
    â”œâ”€â”€ auth.validator.js
    â”œâ”€â”€ deal.validator.js
    â””â”€â”€ comment.validator.js
 
 3. Installation
1ï¸ Cloner le projet
git clone <URL_DU_REPO>
cd dealexpress

2ï¸ Installer les dÃ©pendances
npm install

3ï¸ Variables dâ€™environnement

CrÃ©er un fichier .env :

PORT=3000
MONGODB_URI=mongodb://localhost:27017/dealexpress
JWT_SECRET=un_secret_tres_important
JWT_EXPIRE=7d

4ï¸ Lancer le serveur
npm run dev

 4. Authentification & Comptes

Lâ€™API utilise JWT pour sÃ©curiser les routes.

RÃ´les disponibles :

user â†’ crÃ©er des deals, commenter, voter

moderator â†’ modÃ©rer les deals

admin â†’ gÃ©rer utilisateurs & rÃ´les

5. Endpoints principaux
ğŸ”¹ 1. Authentification
MÃ©thode	URL	Description
POST	/api/auth/register	CrÃ©er un compte
POST	/api/auth/login	Se connecter
GET	/api/auth/me	Voir son profil
ğŸ”¹ 2. Deals
MÃ©thode	URL	Description
GET	/api/deals	Voir les deals approuvÃ©s
GET	/api/deals/:id	Voir un deal
POST	/api/deals	CrÃ©er un deal
PUT	/api/deals/:id	Modifier son deal
DELETE	/api/deals/:id	Supprimer son deal
ğŸ”¹ 3. Votes
MÃ©thode	URL	Description
POST	/api/deals/:id/vote	Voter hot ou cold
DELETE	/api/deals/:id/vote	Supprimer son vote
ğŸ”¹ 4. Commentaires
MÃ©thode	URL	Description
POST	/api/comments/:dealId	CrÃ©er un commentaire
PUT	/api/comments/:id	Modifier un commentaire
DELETE	/api/comments/:id	Supprimer un commentaire
GET	/api/comments/:dealId	Voir les commentaires dâ€™un deal
ğŸ”¹ 5. Admin (role: admin)
MÃ©thode	URL	Description
GET	/api/admin/users	Voir tous les utilisateurs
PATCH	/api/admin/users/:id/role	Modifier un rÃ´le
PATCH	/api/admin/deals/:id/moderate	Changer le statut dâ€™un deal

 6. Base de donnÃ©es (MongoDB)

Collections principales :

users

deals

comments

Exemple dâ€™un document User
{
  "_id": "692c9b8d6ee39e4418c77cf2",
  "username": "mahdi1",
  "email": "mahdi1@test.com",
  "role": "admin"
}

 7. SÃ©curitÃ©

Hash des mots de passe avec bcryptjs

Tokens JWT (expiration configurÃ©e)

Middleware authenticate pour sÃ©curiser les routes

Middleware authorizeRoles pour limiter l accÃ¨s (moderator / admin)

8. Validation

Chaque route est sÃ©curisÃ©e avec express-validator :

 login
 register
 crÃ©ation de deal
 crÃ©ation de commentaire

 9. Tests via Thunder Client / Postman

Le projet peut Ãªtre testÃ© en utilisant Thunder Client :

Auth â†’ Bearer token

Body â†’ JSON

Tester toutes les routes CRUD

Tester la modÃ©ration

Tester les rÃ´les

 10. Points forts du projet

Architecture MVC claire

Auth & rÃ´les avancÃ©s

ModÃ©ration intÃ©grÃ©e

Votes hot/cold avec logique intelligente

Validation robuste

Compatible front-end (React, Next.js, etc.)

Code lisible, structurÃ©, professionnel

13. Comptes de test (User / Moderator / Admin)

Pour faciliter les tests de lâ€™API, trois comptes sont fournis :
 
 USER â€“ Compte utilisateur standard

Ce compte permet :

crÃ©er des deals

commenter

voter

voir les deals approuvÃ©s

Email : user@test.com
Password : user123
Role : user

MODERATOR â€“ Compte modÃ©rateur

Ce compte permet :

toutes les actions du user

approuver / refuser les deals

Email : moderator@test.com
Password : moderator123
Role : moderator

 ADMIN â€“ Compte administrateur

Ce compte permet :

toutes les actions du user

voir tous les utilisateurs

modifier les rÃ´les

modÃ©rer les deals

supprimer nâ€™importe quel contenu


Email : mahdi1@test.com
Password : admin123
Role : admin

14. Collection Postman / Thunder Client

Lâ€™API est entiÃ¨rement testable via Postman ou Thunder Client.
La collection exportÃ©e inclut :

Authentification (register, login, me)

Gestion des deals (CRUD)

Votes (hot/cold)

Commentaires (CRUD)

ModÃ©ration

Routes Admin (gestion des comptes & rÃ´les)


DealExpress API.postman_collection.json
â”‚
â”œâ”€â”€ Auth
â”‚   â”œâ”€â”€ Register
â”‚   â”œâ”€â”€ Login
â”‚   â””â”€â”€ Me
â”‚
â”œâ”€â”€ Deals
â”‚   â”œâ”€â”€ Create Deal
â”‚   â”œâ”€â”€ Get Deals
â”‚   â”œâ”€â”€ Get Deal By ID
â”‚   â”œâ”€â”€ Update Deal
â”‚   â””â”€â”€ Delete Deal
â”‚
â”œâ”€â”€ Votes
â”‚   â”œâ”€â”€ Vote Deal
â”‚   â””â”€â”€ Remove Vote
â”‚
â”œâ”€â”€ Comments
â”‚   â”œâ”€â”€ Create Comment
â”‚   â”œâ”€â”€ Update Comment
â”‚   â”œâ”€â”€ Delete Comment
â”‚   â””â”€â”€ Get Comments by Deal
â”‚
â””â”€â”€ Admin
    â”œâ”€â”€ Get All Users
    â”œâ”€â”€ Change User Role
    â””â”€â”€ Moderate Deal

 15. Comptes de test
 
USER
Email : user@test.com
Password : user123
Role : user

MODERATOR
Email : moderator@test.com
Password : moderator123
Role : moderator

ADMIN
Email : mahdi1@test.com
Password : admin123
Role : admin

 Collection Postman

Une collection Postman/Thunder Client est fournie pour tester :

lâ€™authentification

la gestion des deals

les votes

les commentaires

la modÃ©ration

les routes administrateurs