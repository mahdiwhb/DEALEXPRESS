 DealExpress â€“ API Backend (Node.js / Express / MongoDB)

DealExpress est une API REST complÃ¨te permettant de gÃ©rer des deals, votes, commentaires, utilisateurs, modÃ©rateurs et administrateurs.

Ce projet a Ã©tÃ© dÃ©veloppÃ© dans le cadre dâ€™un exercice pratique visant Ã  mettre en place :

un systÃ¨me dâ€™authentification sÃ©curisÃ© (JWT)

un CRUD complet sur les deals

un systÃ¨me de modÃ©ration

un systÃ¨me de votes (hot / cold)

un systÃ¨me de commentaires sur les deals

une gestion des rÃ´les (user / moderator / admin)

une base de donnÃ©es MongoDB structurÃ©e

 1. Technologies utilisÃ©es

Node.js

Express.js

MongoDB + Mongoose

JWT (JSON Web Token)

bcryptjs

express-validator

dotenv

Nodemon (pour le dÃ©veloppement)

2. Structure du projet
src/
â”‚
â”œâ”€â”€ app.js
â”œâ”€â”€ config/
â”‚   â””â”€â”€ database.js
â”‚
â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ auth.controller.js
â”‚   â”œâ”€â”€ deal.controller.js
â”‚   â”œâ”€â”€ comment.controller.js
â”‚   â””â”€â”€ admin.controller.js
â”‚
â”œâ”€â”€ middlewares/
â”‚   â”œâ”€â”€ auth.middleware.js
â”‚   â””â”€â”€ role.middleware.js
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ User.js
â”‚   â”œâ”€â”€ Deal.js
â”‚   â””â”€â”€ Comment.js
â”‚
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.routes.js
â”‚   â”œâ”€â”€ deals.routes.js
â”‚   â”œâ”€â”€ comments.routes.js
â”‚   â””â”€â”€ admin.routes.js
â”‚
â””â”€â”€ validators/
    â”œâ”€â”€ auth.validator.js
    â”œâ”€â”€ deal.validator.js
    â””â”€â”€ comment.validator.js
 
 3. Installation
1ï¸ Cloner le projet
git clone <URL_DU_REPO>
cd dealexpress

2ï¸ Installer les dÃ©pendances
npm install

3ï¸ Variables dâ€™environnement

CrÃ©er un fichier .env :

PORT=3000
MONGODB_URI=mongodb://localhost:27017/dealexpress
JWT_SECRET=un_secret_tres_important
JWT_EXPIRE=7d

4ï¸ Lancer le serveur
npm run dev

 4. Authentification & Comptes

Lâ€™API utilise JWT pour sÃ©curiser les routes.

RÃ´les disponibles :

user â†’ crÃ©er des deals, commenter, voter

moderator â†’ modÃ©rer les deals

admin â†’ gÃ©rer utilisateurs & rÃ´les

5. Endpoints principaux
ğŸ”¹ 1. Authentification
MÃ©thode	URL	Description
POST	/api/auth/register	CrÃ©er un compte
POST	/api/auth/login	Se connecter
GET	/api/auth/me	Voir son profil
ğŸ”¹ 2. Deals
MÃ©thode	URL	Description
GET	/api/deals	Voir les deals approuvÃ©s
GET	/api/deals/:id	Voir un deal
POST	/api/deals	CrÃ©er un deal
PUT	/api/deals/:id	Modifier son deal
DELETE	/api/deals/:id	Supprimer son deal
ğŸ”¹ 3. Votes
MÃ©thode	URL	Description
POST	/api/deals/:id/vote	Voter hot ou cold
DELETE	/api/deals/:id/vote	Supprimer son vote
ğŸ”¹ 4. Commentaires
MÃ©thode	URL	Description
POST	/api/comments/:dealId	CrÃ©er un commentaire
PUT	/api/comments/:id	Modifier un commentaire
DELETE	/api/comments/:id	Supprimer un commentaire
GET	/api/comments/:dealId	Voir les commentaires dâ€™un deal
ğŸ”¹ 5. Admin (role: admin)
MÃ©thode	URL	Description
GET	/api/admin/users	Voir tous les utilisateurs
PATCH	/api/admin/users/:id/role	Modifier un rÃ´le
PATCH	/api/admin/deals/:id/moderate	Changer le statut dâ€™un deal
ğŸ›¢ 6. Base de donnÃ©es (MongoDB)

Collections principales :

users

deals

comments

Exemple dâ€™un document User
{
  "_id": "692c9b8d6ee39e4418c77cf2",
  "username": "mahdi1",
  "email": "mahdi1@test.com",
  "role": "admin"
}

ğŸ” 7. SÃ©curitÃ©

Hash des mots de passe avec bcryptjs

Tokens JWT (expiration configurÃ©e)

Middleware authenticate pour sÃ©curiser les routes

Middleware authorizeRoles pour limiter l accÃ¨s (moderator / admin)

8. Validation

Chaque route est sÃ©curisÃ©e avec express-validator :

âœ” login
âœ” register
âœ” crÃ©ation de deal
âœ” crÃ©ation de commentaire

 9. Tests via Thunder Client / Postman

Le projet peut Ãªtre testÃ© en utilisant Thunder Client :

Auth â†’ Bearer token

Body â†’ JSON

Tester toutes les routes CRUD

Tester la modÃ©ration

Tester les rÃ´les

 10. Points forts du projet

Architecture MVC claire

Auth & rÃ´les avancÃ©s

ModÃ©ration intÃ©grÃ©e

Votes hot/cold avec logique intelligente

Validation robuste

Compatible front-end (React, Next.js, etc.)

Code lisible, structurÃ©, professionnel